SPUP_ADMIN=function($){function e(e){"trigger-click"==e||"visible"==e?($(".spu-trigger-number").hide(),$(".spu-trigger-value").fadeIn()):"exit-intent"==e?($(".spu-trigger-number").hide(),$(".spu-trigger-value").hide()):($(".spu-trigger-value").hide(),$(".spu-trigger-number").fadeIn())}function t(){SPUP_ADMIN.spu_editor=$("#content_ifr").contents().find("html #tinymce");var e=!1,t=SPUP_ADMIN.spu_editor.text();SPUP_ADMIN.spu_editor.find(".spu-box-container").length&&(e=!0,t=SPUP_ADMIN.spu_editor.html()),""==t&&SPUP_ADMIN.spu_editor.html('<h2 style="text-align:center">Support us!</h2><p style="text-align:center">Subscribe to get the latest offers and deals!</p>'),e||SPUP_ADMIN.spu_editor.find("*").wrapAll('<div class="spu-box-container"/>'),spup_js.opts.optin&&"custom"!=spup_js.opts.optin&&s()}function s(){var e=SPUP_ADMIN.spu_editor,t='<input type="email" name="spu-email" class="spu-fields spu-email" placeholder="'+$("#spu_optin_placeholder").val()+'"/>',s='<input type="text" name="spu-name" class="spu-fields spu-name" placeholder="'+$("#spu_optin_name_placeholder").val()+'"/>',i='<button type="submit" class="spu-fields spu-submit">'+$("#spu_optin_submit").val()+'<i class="spu-icon-spinner spu-spinner"></i></button>',n='<div class="spu-fields-container"><form id="spu-optin-form" class="spu-optin-form" action="" method="post"><input type="text" name="email" class="spu-helper-fields"/><input type="text" name="web" class="spu-helper-fields"/>';e.addClass("spu-optin-editor spu-theme-"+spup_js.opts.optin_theme).removeClass("wp-autoresize"),e.find(".spu-fields-container").remove(),$(".spu-appearance").hide(),"1"==spup_js.opts.optin_display_name&&(n+=s,e.addClass("with-spu-name")),n+=t,n+=i,n+="</form></div>",$(n).appendTo(e.find(".spu-box-container"))}function i(){var e=$("#content_ifr").contents().find("html #tinymce");e.find(".spu-fields-container").remove(),e.alterClass("spu-theme-*","")}var n="";return $(document).ready(function(){$(".spu_reset_stats").on("click",function(){return confirm(spuvar.l18n.reset_stats)}),e($("#spu_trigger").val()),$("#spu_trigger").change(function(){e($(this).val())}),$("#spu_optin").change(function(){var e=$(".optin-spinner"),t=$(this);""==t.val()?($(".optin_opts").removeClass("visible"),i()):"custom"==t.val()?($(".optin_opts").removeClass("visible"),$(".optin_theme").addClass("visible"),i()):(s(),$(".optin_opts").addClass("visible").fadeIn(),e.fadeIn(),t.prop("disabled",!0),$.ajax({method:"POST",url:ajaxurl,data:{action:"spu_get_optin_lists",optin:t.val()}}).done(function(s){e.fadeOut(),t.prop("disabled",!1),s?($("#spu_optin_list").html(s),$(".optin_list").fadeIn()):$("#spu_optin_list").html("")}))}),$("#spu_optin_list").change(function(){var e=$(".optin-spinner"),t=$(this);e.fadeIn(),t.prop("disabled",!0),$.ajax({method:"POST",url:ajaxurl,data:{action:"spu_get_optin_list_segments",list:t.val(),optin:$("#spu_optin").val()}}).done(function(s){e.fadeOut(),t.prop("disabled",!1),s?($(".optin_list_segments .result").html(s),$(".optin_list_segments").fadeIn()):($(".optin_list_segments .result").html(""),$(".optin_list_segments").fadeOut())})}),$("#spu_optin_display_name").change(function(){var e=SPUP_ADMIN.spu_editor,t='<input type="text" class="spu-fields spu-name" placeholder="'+spup_js.opts.optin_name_placeholder+'" name="spu-name"/>';e.toggleClass("with-spu-name"),"1"==$(this).val()?e.find("#spu-optin-form").prepend(t):e.find(".spu-fields.spu-name").remove()}),$("#spu_optin_placeholder").blur(function(){var e=SPUP_ADMIN.spu_editor,t=$(this).val();e.find(".spu-email").prop("placeholder",t)}),$("#spu_optin_name_placeholder").blur(function(){var e=SPUP_ADMIN.spu_editor,t=$(this).val();e.find(".spu-name").prop("placeholder",t)}),$("#spu_optin_submit").blur(function(){var e=SPUP_ADMIN.spu_editor,t=$(this).val();e.find(".spu-submit").text(t)}),$(".optin_themes .theme").on("click",function(){var e=SPUP_ADMIN.spu_editor,t=$(this).data("theme");$(".optin_themes .theme").removeClass("selected"),$(this).addClass("selected"),$("#spu_optin_theme").val(t),e.alterClass("spu-theme-*","spu-theme-"+t)}),$(".toggle-provider").click(function(e){e.preventDefault(),$(this).closest(".collapse-div").toggleClass("active")})}),{onTinyMceInit:function(){t()}}}(jQuery),function($){$.fn.alterClass=function(e,t){var s=this;if(-1===e.indexOf("*"))return s.removeClass(e),t?s.addClass(t):s;var i=new RegExp("\\s"+e.replace(/\*/g,"[A-Za-z0-9-_]+").split(" ").join("\\s|\\s")+"\\s","g");return s.each(function(e,t){for(var s=" "+t.className+" ";i.test(s);)s=s.replace(i," ");t.className=$.trim(s)}),t?s.addClass(t):s}}(jQuery);