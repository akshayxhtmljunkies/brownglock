!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=function(){"use strict";var b=a("./Wizard.js"),c=a("./FieldMapper.js"),d=window.jQuery,e=document.getElementById("wizard");e&&m.module(e,b),new c(d(".mc4wp-sync-field-map"))}();b.exports=d},{"./FieldMapper.js":2,"./Wizard.js":5}],2:[function(a,b,c){var d=function(a){function b(){var b=a.find(".row").last(),c=b.clone(),e=c.find(".user-field"),f=c.find(".mailchimp-field");return e.val("").suggest(ajaxurl+"?action=mcs_autocomplete_user_field").attr("name",e.attr("name").replace(/\[(\d+)\]/,function(a,b){return"["+(parseInt(b,10)+1)+"]"})),f.val("").attr("name",f.attr("name").replace(/\[(\d+)\]/,function(a,b){return"["+(parseInt(b,10)+1)+"]"})),c.insertAfter(b),d(),!1}function c(){e(this).parents(".row").remove(),d()}function d(){var b=a.find(".mailchimp-field");b.each(function(){var a=b.not(this),c=e.map(a,function(a,b){return e(a).val()});e(this).find("option").each(function(){e(this).prop("disabled",e.inArray(e(this).val(),c)>-1)})})}var e=window.jQuery;a.find(".user-field").suggest(ajaxurl+"?action=mcs_autocomplete_user_field"),a.find(".mailchimp-field").change(d).trigger("change"),a.find(".add-row").click(b),a.on("click",".remove-row",c)};b.exports=d},{}],3:[function(a,b,c){var d=function(){var a=this;this.items=m.prop([]),this.addLine=function(b){var c={time:new Date,text:b};a.items().push(c),m.redraw()},this.addTextToLastLine=function(b){var c=a.items().pop();c.text+=" "+b,a.items().push(c),m.redraw()},this.scrollToBottom=function(a,b,c){a.scrollTop=a.scrollHeight},this.render=function(){return m("div.log",{config:a.scrollToBottom},[a.items().map(function(a){var b=("0"+a.time.getHours()).slice(-2)+":"+("0"+a.time.getMinutes()).slice(-2)+":"+("0"+a.time.getSeconds()).slice(-2);return m("p",[m("span.time",b),m.trust(a.text)])})])}};b.exports=d},{}],4:[function(a,b,c){var d=function(a){this.id=m.prop(a.ID),this.username=m.prop(a.user_login),this.email=m.prop(a.user_email)};b.exports=d},{}],5:[function(a,b,c){var d=a("./Log.js"),e=a("./User.js"),f=function(){function a(){}function b(){var a=confirm("Are you sure you want to start synchronising all of your users? This can take a while if you have many users, please don't close your browser window.");a&&c()}function c(){n=!0,o=!0,h().then(i).then(j)}function f(){o=!0,j(),m.redraw()}function g(){o=!1,m.redraw()}function h(){var a=m.deferred(),b={action:"mcs_wizard",mcs_action:"get_user_count",role:v.value};return m.request({method:"GET",url:ajaxurl,data:b}).then(function(b){t.addLine("Found "+b+" users."),q=b,a.resolve()}),a.promise}function i(){var a=m.deferred();return m.request({method:"GET",url:ajaxurl,data:{action:"mcs_wizard",mcs_action:"get_users",offset:r,role:v.value},type:e}).then(function(b){t.addLine("Fetched "+b.length+" users."),u(b),a.resolve(),m.redraw()},function(a){t.addLine("Error fetching users. Error: "+a)}),a.promise}function j(){if(!o||p)return!1;if(0===u().length)return r>=q?!1:(i().then(j),!1);var a=u().shift();t.addLine("Synchronising <strong>user #"+a.id()+" "+a.username()+"</strong> (Email: <strong>"+a.email()+"</strong>).");var b={action:"mcs_wizard",mcs_action:"subscribe_users",user_ids:[a.id()]};m.request({method:"GET",data:b,url:ajaxurl}).then(function(a){a.success&&t.addTextToLastLine("Success!"),a.error&&t.addTextToLastLine("Error: "+a.error),r++,k()},function(a){t.addLine("Error: "+a)}).then(j,j)}function k(){var a=Math.round(r/q*100);s(a),a>=100&&(p=!0,t.addLine("Done!"))}function l(){return n?[p?"":m("p",[m("input",{type:"button","class":"button",value:o?"Pause":"Resume",onclick:o?g:f})]),m("div.progress-bar",[m("div.value",{style:"width: "+s()+"%"}),m("div.text",{},100==s()?"Done!":"Working: "+s()+"%")]),t.render()]:m("p",[m("input",{type:"button","class":"button",value:"Synchronise All",onclick:b})])}var n=!1,o=!1,p=!1,q=0,r=0,s=m.prop(0),t=new d,u=m.prop([]),v=document.getElementById("role-select");return a(),{controller:a,view:l}}();b.exports=f},{"./Log.js":3,"./User.js":4}]},{},[1]);